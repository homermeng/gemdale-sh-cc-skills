---
name: project-planning
description: 金地上海地区公司，项目管理技能，项目“万项节点计划”生成和分解.
license: MIT
metadata:
  version: 1.0.0
  author: Homer Meng
  category: Project Management
  domain: Scheduling, Planning, Project Control
  updated: 2026-1-28
---

# Project Planning Skill

基于房地产开发项目计划模板，结合项目具体情况，编制详细开发计划的技能。

## 功能描述

本技能用于房地产开发项目工程计划的编制，核心功能包括：

1. **模板加载与分析**：加载标准房地产开发计划模板（template.mpp），解析任务结构、逻辑关系、里程碑节点
2. **项目信息适配**：根据具体项目信息（城市、地块、楼栋、批次等）调整计划
3. **技术变量调整**：根据技术变量（地下室层数、基础形式、PC构件、外墙形式等）调整任务周期
4. **里程碑约束**：基于用户提供的里程碑时间（预售、封顶、竣备、交付等）进行计划压缩或调整
5. **计划生成与保存**：生成项目专属的.mpp计划文件

## 使用场景

当用户提出以下需求时，应使用本技能：

- "编制XX项目的开发计划"
- "基于模板生成XX楼栋的详细计划"
- "根据项目情况调整工程计划"
- "创建施工进度计划"

## 工作流程

### 第一步：收集项目信息

在开始编制计划前，必须收集以下信息：

**项目基本信息**（来自 scheduling_vars.md 一、项目信息）：
- 所处城市
- 地块名称、项目名称（备案名/推广名）
- 交付批次、预售批次、施工批次划分
- 楼栋信息：数量、层数、业态（高层/多层/洋房/别墅等）
- 地下室层数
- 预售形象要求

**里程碑时间**（如有）：
- 考核/内控预售时间
- 考核/内控封顶时间
- 考核/内控竣备时间
- 考核/内控交付时间
- 合同交付时间
- 各类证照获取时间

**技术变量**（来自 scheduling_vars.md 二、技术变量）：
- 地下：土质情况、地下水、周边建筑、土方及支护方式、基础工程形式
- 地上：PC构件情况、保温形式、屋面形式、外墙形式、室内粗装饰、地库装饰/地面
- 其他：冬歇、春节、中高考停工等

### 第二步：加载并分析模板

使用 `MSProject_rev2.py` 中的 `MSProject` 类加载模板：

```python
from MSProject_rev2 import MSProject

# 创建MSProject实例
msp = MSProject()

# 加载模板文件
msp.load('template.mpp')

# 读取任务信息
# 注意：模板使用自定义字段存储任务信息
```

### 第三步：分析模板任务结构

1. 读取模板中的所有任务
2. 分析任务之间的依赖关系（前置任务）
3. 识别关键路径任务
4. 记录任务的周期（Duration）、开始时间（Start）、完成时间（Finish）

### 第四步：根据项目情况调整

**基于技术变量调整任务周期**：
- 地下室层数变化 → 调整地下施工相关任务周期
- 基础形式不同 → 按scheduling_vars.md中的标准周期调整基础工程任务
- PC构件使用 → 减少主体结构施工周期
- 外墙形式不同 → 调整外立面施工任务内容和周期
- 等等...

**基于里程碑约束调整**：
- 如果用户指定了某里程碑时间，需要以该时间为目标
- 反向推导前置任务的完成时间
- 必要时压缩任务周期（保持合理的施工逻辑）

**批次和楼栋处理**：
- 同一批次内多个楼栋可并行施工
- 不同批次按顺序或适当搭接

### 第五步：生成并保存计划

```python
# 保存调整后的计划
msp.save('项目名称_开发计划.mpp')

# 关闭
msp.saveAndClose()
```

## 参考文件说明

### template.mpp
- 标准房地产开发计划模板（原文件：泗泾单栋计划初稿.mpp）
- 包含完整的房地产开发任务序列和逻辑关系

### MSProject_rev2.py
- MSProject文件操作Python库
- 主要类和方法：
  - `MSProject`: 主类
  - `load(filepath)`: 加载.mpp文件
  - `save(filepath)`: 保存文件
  - `saveAndClose()`: 保存并关闭
  - `dump()`: 打印项目信息用于调试
  - `Tasks`: 任务集合
  - `addTask()`: 添加新任务
  - `setTaskField()`: 设置任务字段
  - `getTaskByID()`: 根据ID获取任务
  - `findRange()`: 查找子任务范围

### scheduling_vars.md
- 详细说明了影响计划编制的两大类变量
- **项目信息**：基本信息、批次划分、楼栋信息、预售形象、证照时间
- **技术变量**：地下施工、地上施工、其他因素（冬歇、停工等）
- 各技术变量对应的标准周期参考

## 注意事项

1. **MS Project依赖**：本技能需要Windows环境安装Microsoft Project软件，使用win32com客户端进行操作
2. **施工逻辑**：调整任务周期时必须保持合理的施工逻辑，不能违反工艺顺序
3. **工作日历**：考虑节假日、冬歇期等非工作日
4. **并行施工**：合理的工序穿插可以提高效率
5. **验证检查**：生成计划后应检查关键路径和里程碑节点是否合理

## 示例

```
用户：请编制方松项目1号楼的开发计划，该项目位于上海，共18层高层，
      地下2层，基础采用预应力管桩，无PC构件，外墙采用真石漆，
      预计2024年6月1日开工，2025年12月31日交付。

Agent执行：
1. 收集项目信息（如上）
2. 加载template.mpp
3. 根据地下2层调整地下室施工周期
4. 根据预应力管桩设置基础工程周期为45天
5. 根据无PC构件保持主体结构原周期
6. 根据真石漆外立面调整外立面施工周期
7. 以2025年12月31日交付为目标，反向调整各任务时间
8. 生成方松项目_1号楼_开发计划.mpp
```
